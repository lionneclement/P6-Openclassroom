{% extends 'base.html.twig' %}

{% block title %}{{ trick.title }}{% endblock %}

{% block body %}
<header>
  <div class="view" style="background-image: url({{ asset('Images/default-top.jpg') }})">
        <div class="container">
          <div class="header-text text-center">
            <h1>{{ trick.title }}</h1>
            <p>{{ trick.description|slice(0, 100) }}...</p>
          </div>
    </div>
  </div>
</header>
<section class="py-3">
  <div class="text-center">
    <a class="btn btn-secondary" data-toggle="collapse" href="#mediaCollapse" role="button" aria-expanded="false" aria-controls="mediaCollapse">
      Voir les m√©dias
    </a>
  </div>
  <div class="collapse" id="mediaCollapse">
      <div class="container">
        <div class="row">
        {% for photo in photos %}
            <div class="card col-md-3">
              <img class="card-img-top" src="{{asset('Upload/'~ photo.name)}}" alt="{{trick.title}}">
              <div class="card-body text-center">
                <a class="btn btn-secondary btn-sm" href="{{url('remove_photo', {'photoId':photo.id})}}">Supprimer</a>
              </div>
            </div>
        {% endfor %} 
      </div>
    </div>
  </div>
</section>
<div class="container pt-3">
  <div class="text-center pb-5">
        <p class="card-text">{{ trick.description }}</p>
        <h5>Groupe</h5>
        <p class="card-title">{{ trick.StyleId.Name}}</p>
        <a class="btn btn-secondary" href="/tricks/update/{{ trick.id }}">Modifier</a>
  </div>  
</div>

<section id="commentaire">
  <hr>
  <div class="container text-center">
      <h4 class="mb-4">Commentaire</h4>
    {% for message in app.flashes('success') %}
          <div class="alert alert-success text-center" role="alert">
              {{ message }}
          </div>
        {% endfor %}
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        {{ form_start(form) }}
          {{ form_row(form.Message) }}
          <button class="btn btn-secondary" type="submit">Confirmer</button>
        {{ form_end(form) }}
        {% endif %}
  </div>
</section>
<section class="pb-5">
  <hr>
  <div class="pb-5 container text-center">
    {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
          <div class="alert alert-danger text-center" role="alert">
              Connecter vous pour pouvoir commenter.
          </div>
        {% endif %}
        <h4>Tout les commentaires</h4>
        {% if not comments %}
          <div class="alert alert-danger text-center" role="alert">
              Il n'y a pas encore de commentaires.
          </div>
        {% endif %}
        {% for comment in comments %}
            {% if comment.UserId.ImageName == 'default-user.png' %}
                {% set directory = 'Images' %}
            {% else %}
                {% set directory = 'Upload' %}
            {% endif %}
          <img src="{{asset(directory ~'/'~ comment.UserId.ImageName)}}" class="avatar-min" alt="Photo de profil">
          <p class="card-text">Auteur: {{ comment.UserId.Name }}</p>
          <p class="card-text">Message: {{ comment.Message }}</p>
          <p class="card-text">Date: {{ comment.Date|date("d/m/Y")}}</p>
        {% endfor %}
  </div>
</section>
{% endblock %}